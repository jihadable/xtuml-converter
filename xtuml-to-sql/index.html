<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>xtUML to SQL</title>
  <link rel="stylesheet" href="../styles/navbar.css">
  <link rel="stylesheet" href="../styles/convert-section.css">
  <style>
    body {
      display: flex;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background-color: #fff;
      padding: 20px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    .input-section {
      margin-bottom: 20px;
    }
    textarea {
      width: 100%;
      height: 200px;
      padding: 10px;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 4px;
      background-color: #f9f9f9;
      resize: vertical;
    }
    .btn-container {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 20px;
    }
    button {
      padding: 10px 20px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      flex: 1;
      min-width: 100px;
    }
    button:hover {
      background-color: #45a049;
    }
    .clear-btn {
      background-color: #f44336;
    }
    .clear-btn:hover {
      background-color: #e53935;
    }
    .output-section {
      margin-top: 20px;
      background-color: #f4f4f9;
      padding: 20px;
      border-radius: 4px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    pre {
      background-color: #333;
      color: #fff;
      padding: 15px;
      border-radius: 4px;
      font-size: 14px;
      overflow-x: auto;
    }
    .error {
      color: red;
      font-size: 14px;
      margin-top: 10px;
    }
    .info {
      background-color: #e7f4fa;
      border-left: 6px solid #2196F3;
      padding: 10px;
      font-size: 14px;
      color: #333;
      border-radius: 4px;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="navbar-overflow">
        <div class="logo">
            <img src="https://upload.wikimedia.org/wikipedia/id/c/c6/Logo_UIN_Sunan_Kalijaga.png" alt="UIN SUKA">
        </div>
        <div class="links">
          <a href="../xtuml-to-javascript/" class="link">xtUML to Javascript</a>
          <a href="../xtuml-to-go/" class="link">xtUML to Go</a>
          <a href="../xtuml-to-c/" class="link">xtUML to C</a>
          <a href="../xtuml-to-dart/" class="link">xtUML to Dart</a>
          <a href="../xtuml-to-cpp/" class="link">xtUML to C++</a>
          <a href="../xtuml-to-ruby/" class="link">xtUML to Ruby</a>
          <a href="../xtuml-to-python/" class="link">xtUML to Python</a>
          <a href="../xtuml-to-swift/" class="link">xtUML to Swift</a>
          <a href="../xtuml-to-php/" class="link">xtUML to PHP</a>
          <a href="../xtuml-to-typescript/" class="link">xtUML to Typescript</a>
          <a href="../xtuml-to-java/" class="link">xtUML to Java</a>
          <a href="../xtuml-to-kotlin/" class="link">xtUML to Kotlin</a>
          <a href="../xtuml-to-csharp/" class="link">xtUML to C#</a>
          <a href="../xtuml-to-sql/" class="link">xtUML to SQL</a>
          <a href="../visualization/" class="link">Visualization</a>
        </div>
    </div>
</nav>
<div class="convert-section">
  <div class="convert">
    <div class="container">
      <h1>JSON to SQL Converter</h1>
      <div class="input-section">
        <label for="jsonInput">Input JSON:</label>
        <textarea id="jsonInput" placeholder="Paste your JSON here"></textarea>
      </div>
      <div class="btn-container">
        <button onclick="convertToSQL()">Convert to SQL</button>
        <button class="clear-btn" onclick="clearText()">Clear</button>
        <button onclick="showInfo()">Info(i)</button>
        <button onclick="showHelp()">Help(?)</button>
      </div>
      <div class="output-section">
        <h2>SQL Output</h2>
        <pre id="sqlOutput">Your SQL result will appear here...</pre>
        <div id="errorMessage" class="error"></div>
      </div>
    </div>
  </div>
</div>

  <script>
    function convertToSQL() {
      const jsonInput = document.getElementById('jsonInput').value;
      const sqlOutput = document.getElementById('sqlOutput');
      const errorMessage = document.getElementById('errorMessage');
      
      // Clear previous messages
      errorMessage.style.display = 'none';
      sqlOutput.textContent = 'Your SQL result will appear here...';

      try {
        // Parse the input JSON
        const jsonObj = JSON.parse(jsonInput);
        
        let sqlQuery = '';
        
        // Function to recursively create SQL queries
        function generateSQL(tableName, jsonData) {
          const columns = Object.keys(jsonData);
          const values = columns.map(col => `'${jsonData[col]}'`).join(", ");
          
          sqlQuery += `INSERT INTO ${tableName} (${columns.join(", ")}) VALUES (${values});\n`;

          // If the data contains nested objects, call recursively for each nested object
          columns.forEach(col => {
            if (typeof jsonData[col] === 'object' && !Array.isArray(jsonData[col])) {
              generateSQL(col, jsonData[col]);
            }
            if (Array.isArray(jsonData[col])) {
              jsonData[col].forEach((item, index) => {
                generateSQL(`${col}_${index + 1}`, item);
              });
            }
          });
        }

        // Start recursive SQL generation
        generateSQL("root_table", jsonObj);
        
        // Display the SQL output if no errors occurred
        sqlOutput.textContent = sqlQuery;

      } catch (error) {
        // Display error message
        errorMessage.style.display = 'block';
        errorMessage.textContent = 'Error: ' + error.message;
      }
    }

    function clearText() {
      document.getElementById('jsonInput').value = ''; // Clear JSON input
      document.getElementById('sqlOutput').textContent = 'Your SQL result will appear here...'; // Clear SQL output
      document.getElementById('errorMessage').style.display = 'none'; // Hide error message
    }

    function showInfo() {
      alert(`This tool converts structured JSON data into SQL INSERT queries. It's designed for developers and data engineers who need quick transformations from JSON to SQL format.`)
    }

    function showHelp() {
      alert('1. Paste your JSON data into the input box.\n2. Click the "Convert to SQL" button to generate SQL queries.\n3. Use the "Clear" button to reset the input and output.\n4. Ensure your JSON structure is properly formatted for the tool to work effectively.')
    }
  </script>
</body>
</html>
